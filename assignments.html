---
---

<!DOCTYPE html>
<html>
<head>
    <link href="https://fonts.googleapis.com/css?family=Oxygen&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="general.css">
</head>
<body>
    {% include header2.html %}
    <header></header>

    <main class="container">
        <a href="/Jobify/dashboard.html">
            <button>Back to Dashboard</button>
        </a>

        <div id="assignmentDiv"></div>
        
        <form id="assignmentForm">
            <h2>Submit Your Assignment</h2>
            <p>Please fill out the form below to submit your assignment. Make sure to provide all the necessary details.</p>
            <label for="title">Title:</label><br>
            <input type="text" id="title2" name="title" style="width: 100%;"><br>
            <label for="desc">Description:</label><br>
            <textarea id="desc" name="desc" rows="4" cols="50" style="width: 100%;"></textarea><br>
            <label for="contributors">Contributors (comma separated):</label><br>
            <input type="text" id="contributors" name="contributors" style="width: 100%;"><br>
            <label for="username">Username:</label><br>
            <input type="text" id="username2" name="username" style="width: 100%;"><br>
            <label for="link">Link:</label><br>
            <input type="text" id="link" name="link" style="width: 100%;"><br>
            <input type="submit" value="Submit">
        </form>
        <br><br>

        <div id="submissionsDiv"></div>
    </main>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        var url = new URL(window.location.href);
        var id = url.searchParams.get("id");
        $.get("http://localhost:8091/api/assignments/" + id , function(data) {
            var html;
            var html2;
            
            var assignment = data;
            if (assignment) {
                html = '<h1 style="font-size: 2.2em; font-weight: bold; margin-bottom: 0; font-family: Oxygen;">' + assignment.title + '</h1>';
                html += '<p style="font-size: 0.8em; font-style: italic; margin-bottom: 0; font-family: Oxygen;">Due: ' + new Date(assignment.due).toLocaleString() + ' | Worth ' + assignment.maxPoints + ' Points --- <a href="' + assignment.link + '" style="text-decoration: underline;">Corresponding Notebook</a></p>';
                html += '<p style="font-size: 1.1em; font-family: Oxygen;">' + assignment.desc + '</p>';
            
                for (var username in assignment.submissions) {
                  var submission = assignment.submissions[username];
                  html2 += '<div class="assignment-card">';
                  html2 += '<h3 style="font-size: 1.6em; font-weight: bold; font-family: Oxygen;"><a href="' + submission.link + '" style="text-decoration: underline;">' + submission.title + '</a></h3>';
                  html2 += '<p style="font-style: italic; font-family: Oxygen;">Posted by ' + username + ' -- Contributed to by ' + submission.contributors.join(', ') + '</p>';
                  html2 += '<p style="font-family: Oxygen;">' + submission.desc + '</p>';
                  html2 += '</div>';
                } 
            } else {
                html = '<h1 style="font-size: 2.2em; font-weight: bold; margin-bottom: 0; font-family: Oxygen;">No assignment with id ' + id + ' exists</h1>'
            }
          
            $('#assignmentDiv').html(html);
            $('#submissionsDiv').html(html2);
        });
    </script>

    <script>
      var url = new URL(window.location.href);
      var id = url.searchParams.get("id");
      $.get("http://localhost:8091/api/assignments/" + id , function(data) {
          var html = '';
          var html2 = '';
          
          var assignment = data;
          if (assignment) {
              html = '<h1 style="font-size: 2.2em; font-weight: bold; margin-bottom: 0; font-family: Oxygen;">' + assignment.title + '</h1>';
              html += '<p style="font-size: 0.8em; font-style: italic; margin-bottom: 0; font-family: Oxygen;">Due: ' + new Date(assignment.due).toLocaleString() + ' | Worth ' + assignment.maxPoints + ' Points --- <a href="' + assignment.link + '" style="text-decoration: underline;">Corresponding Notebook</a></p>';
              html += '<p style="font-size: 1.1em; font-family: Oxygen;">' + assignment.desc + '</p>';
          
              if (assignment.submissions) {
                  for (var username in assignment.submissions) {
                      var submission = assignment.submissions[username];
                      html2 += '<div class="assignment-card">';
                      html2 += '<h3 style="font-size: 1.6em; font-weight: bold; font-family: Oxygen;"><a href="' + submission.link + '" style="text-decoration: underline;">' + submission.title + '</a></h3>';
                      html2 += '<p style="font-style: italic; font-family: Oxygen;">Posted by ' + username + ' -- Contributed to by ' + submission.contributors.join(', ') + '</p>';
                      html2 += '<p style="font-family: Oxygen;">' + submission.desc + '</p>';
                      html2 += '</div>';
                  } 
              }
          } else {
              html = '<h1 style="font-size: 2.2em; font-weight: bold; margin-bottom: 0; font-family: Oxygen;">No assignment with id ' + id + ' exists</h1>'
          }
        
          $('#assignmentDiv').html(html);
          $('#submissionsDiv').html(html2);
      });
      
    </script>


<script>
  window.onload = function() {
  var url = new URL(window.location.href);
  var id = url.searchParams.get("id");
  document.getElementById('assignmentForm').addEventListener('submit', function(event) {
  event.preventDefault();

  var title = document.getElementById('title2').value;
  var desc = document.getElementById('desc').value;
  var contributors = document.getElementById('contributors').value.split(',');
  var username = document.getElementById('username2').value;
  var link = document.getElementById('link').value;

  console.log(id + title + desc + contributors + username + link);

  var data = {
    "id": id.toString(),
    "title": title,
    "desc": desc,
    "contributors": contributors,
    "username": username,
    "link": link
  };

  fetch('http://localhost:8091/api/assignments/submit', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(data),
  })
  .then(response => response.json())
  .then(data => {
      location.reload();
  })
  .catch((error) => {
    console.error('Error:', error);
  });
});
}
</script>
</body>
</html>
